<div class="app-shell flex h-screen w-screen overflow-hidden">
  <!-- Left Sidebar: Channels + User Area -->
  <aside 
    class="sidebar flex flex-col w-[240px] bg-bg-sidebar flex-shrink-0 overflow-hidden border-r border-white/[0.06]"
    [class.hidden]="!sidebarOpen"
    role="navigation" 
    aria-label="Server navigation">
    
    <!-- Sidebar Header -->
    <div class="sidebar-header px-4 py-3 border-b border-white/[0.06] flex items-center justify-between min-h-[48px] shadow-sm">
      <strong class="text-base font-bold text-white tracking-tight">Datasetto</strong>
      <button 
        (click)="toggleSidebar()" 
        class="mobile-sidebar-close-btn"
        type="button" 
        aria-label="Close navigation">
        <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>

    <!-- Channels Section - Using Discord UI Component -->
    <div class="sidebar-scroller flex-1 overflow-y-auto overflow-x-hidden custom-scrollbar">
      @if (categories$ | async; as categories) {
        @if (categories.length > 0) {
          <app-channels-list 
            [categories]="categories"
            [activeChannelId]="(currentChannelId$ | async) || null"
            (channelSelected)="onChannelSelected($event)">
          </app-channels-list>
        } @else {
          <div class="flex items-center justify-center p-4 text-text-muted text-sm">
            No channels available
          </div>
        }
      } @else {
        <div class="flex items-center justify-center p-4 text-text-muted text-sm">
          Loading channels...
        </div>
      }
    </div>

    <!-- User Area -->
    @if (user$ | async; as user) {
      <div class="user-area px-2 py-2 bg-bg-elevated border-t border-white/[0.06] flex items-center gap-3">
        <div class="w-8 h-8 rounded-full bg-brand-primary flex items-center justify-center text-sm font-bold text-white flex-shrink-0">
          {{ user.displayName.charAt(0).toUpperCase() }}
        </div>
        <div class="flex-1 min-w-0">
          <div class="text-sm font-semibold text-white truncate">{{ user.displayName }}</div>
          <div class="text-xs text-text-muted truncate">{{ user.username }}</div>
        </div>
        <button class="p-1.5 rounded hover:bg-modifier-hover transition-fast" title="User Settings">
          <svg class="w-5 h-5 text-interactive-normal" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="3"></circle>
            <path d="M12 1v6m0 6v6m8.66-15l-3.46 3.46M9.8 9.8 6.34 6.34m12.32 12.32-3.46-3.46M9.8 14.2l-3.46 3.46M23 12h-6M7 12H1"></path>
          </svg>
        </button>
      </div>
    }
  </aside>

  <!-- Main Content Area -->
  <main class="flex-1 flex flex-col overflow-hidden bg-bg-primary">
    <router-outlet />
  </main>
</div>
