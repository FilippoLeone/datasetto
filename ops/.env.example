# Production Environment Variables Template
# Copy this file to .env and fill in your values

# ============================================
# Required Configuration
# ============================================

# Superuser secret for admin access
# Generate with: openssl rand -base64 32
SUPERUSER_SECRET=changeme123

# Server URLs - IMPORTANT: Replace with your actual domain or IP

# === RECOMMENDED: With Reverse Proxy (nginx on host) ===
# Use HTTPS URLs without ports (nginx reverse proxy handles routing)
# Works with Cloudflare proxy, Let's Encrypt SSL, or any CDN
SERVER_URL=https://yourdomain.com
HLS_BASE_URL=https://yourdomain.com/hls
API_BASE_URL=https://yourdomain.com

# Site URL for SEO meta tags (Open Graph, Twitter Cards, JSON-LD)
SITE_URL=https://yourdomain.com

# === ALTERNATIVE: Direct IP Access (No reverse proxy) ===
# Use if accessing directly via IP without nginx reverse proxy:
# SERVER_URL=http://YOUR_SERVER_IP:4000
# HLS_BASE_URL=http://YOUR_SERVER_IP/hls
# API_BASE_URL=http://YOUR_SERVER_IP:4000

# ============================================
# Optional Configuration
# ============================================

# CORS Origin (use * for all origins, or specify your domain)
# Comma-separated list of allowed origins for CORS
# Include https://localhost to support Capacitor mobile builds served from the device
CORS_ORIGIN=https://your-domain.com,https://localhost

# Node Environment
NODE_ENV=production

# Server Port
PORT=4000
HOST=0.0.0.0

# Resource Limits
MAX_CONNECTIONS_PER_IP=10
MAX_CHANNELS=50
MAX_USERS_PER_CHANNEL=50
ACCOUNT_SESSION_TTL_MS=604800000

# ============================================
# TURN / WebRTC Voice Configuration
# ============================================

# Public hostname (or IP) clients use to reach your TURN relay
TURN_REALM=turn.your-domain.com

# TURN authentication credentials (long-term mechanism)
TURN_USERNAME=turnuser
TURN_PASSWORD=changeme-strong-password

# Listening interfaces and NAT helpers (leave blank to auto-detect)
# TURN_LISTENING_IP=0.0.0.0
# TURN_ALT_LISTENING_IP=
# TURN_EXTERNAL_IP=

# Networking ports (UDP range must be opened in firewall)
TURN_PORT=3478
TURN_MIN_PORT=49160
TURN_MAX_PORT=49200

# Extra command-line flags passed to coturn (optional, e.g. "--external-ip=PUBLIC_IP")
TURN_EXTRA_ARGS=

# Frontend build variables (client/src/services/VoiceService.ts)
# Provide either a full ICE JSON array OR the shorthand TURN credentials below
# VITE_WEBRTC_ICE_SERVERS='[{"urls":"stun:stun.l.google.com:19302"}]'
VITE_TURN_URL=turn:turn.your-domain.com:3478
VITE_TURN_USERNAME=turnuser
VITE_TURN_CREDENTIAL=changeme-strong-password
VITE_VOICE_OPUS_BITRATE=64000
VITE_VOICE_DTX_ENABLED=true
VITE_VOICE_OPUS_STEREO=false
VITE_VOICE_OPUS_MIN_PTIME=10
VITE_VOICE_OPUS_MAX_PTIME=20
VITE_VOICE_OPUS_MAX_PLAYBACK_RATE=48000
VITE_VOICE_VAD_THRESHOLD=0.07

# ============================================
# Deployment Information (auto-generated)
# ============================================

# DEPLOYED_AT=2025-01-01T00:00:00Z
# SERVER_IP=0.0.0.0
# DOMAIN=stream.example.com

# ============================================
# Caddy Reverse Proxy Configuration
# ============================================

# CADDY_SITE_ADDRESS controls how Caddy listens:
#
# For direct deployment (Caddy manages TLS/HTTPS):
#   CADDY_SITE_ADDRESS=yourdomain.com
#
# For Cloudflare tunnel/proxy (Cloudflare manages TLS):
#   CADDY_SITE_ADDRESS=:80
#
# For IP-only access:
#   CADDY_SITE_ADDRESS=http://YOUR_IP
#
CADDY_SITE_ADDRESS=yourdomain.com
