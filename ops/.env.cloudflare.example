# Cloudflare Tunnel Environment Configuration
# Copy to .env and customize for your setup
#
# IMPORTANT: Read ops/CLOUDFLARE_TUNNEL_SETUP.md for full instructions

# ============================================
# Domain Configuration
# ============================================

# Your domain behind Cloudflare
DOMAIN=yourdomain.com
SERVER_URL=https://yourdomain.com
HLS_BASE_URL=https://yourdomain.com/hls
API_BASE_URL=https://yourdomain.com

# ============================================
# Security
# ============================================

SUPERUSER_SECRET=change-me-to-a-secure-secret

# CORS origins - include your domain and localhost for Capacitor
CORS_ORIGIN=https://yourdomain.com,https://localhost,capacitor://localhost

# ============================================
# TURN Server (Voice/Video)
# ============================================
# 
# ⚠️  CRITICAL: Cloudflare tunnels do NOT support UDP traffic.
#     TURN must be accessed directly via your PUBLIC IP.
#
# Options:
# 1. Port forward UDP 3478, 49160-49200 on your router
# 2. Use an external TURN service (Twilio, Xirsys)
# 3. Accept that voice won't work for users behind strict NAT

# Your PUBLIC IP address (run: curl -s ifconfig.me)
TURN_EXTERNAL_IP=YOUR_PUBLIC_IP_HERE

TURN_REALM=yourdomain.com
TURN_USERNAME=turnuser
TURN_PASSWORD=change-to-strong-password

# TURN ports (these must be port-forwarded on your router)
TURN_PORT=3478
TURN_MIN_PORT=49160
TURN_MAX_PORT=49200

# ============================================
# Client TURN Configuration
# ============================================
#
# Use your PUBLIC IP here, NOT your Cloudflare domain.
# The client connects to TURN directly, bypassing the tunnel.

VITE_TURN_URL=turn:YOUR_PUBLIC_IP_HERE:3478
VITE_TURN_USERNAME=turnuser
VITE_TURN_CREDENTIAL=change-to-strong-password

# ============================================
# Voice Quality Settings
# ============================================

VITE_VOICE_OPUS_BITRATE=64000
VITE_VOICE_DTX_ENABLED=true
VITE_VOICE_OPUS_STEREO=false
VITE_VOICE_OPUS_MIN_PTIME=10
VITE_VOICE_OPUS_MAX_PTIME=20
VITE_VOICE_OPUS_MAX_PLAYBACK_RATE=48000
VITE_VOICE_VAD_THRESHOLD=0.07

# ============================================
# Server Configuration
# ============================================

NODE_ENV=production
PORT=4000
MAX_CONNECTIONS_PER_IP=10
MAX_CHANNELS=50
MAX_USERS_PER_CHANNEL=50

# ============================================
# Mobile Defaults (Optional)
# ============================================

VITE_MOBILE_DEFAULT_SERVER_URL=https://yourdomain.com
VITE_MOBILE_DEFAULT_HLS_URL=https://yourdomain.com/hls
VITE_MOBILE_DEFAULT_RTMP_URL=rtmp://YOUR_PUBLIC_IP_HERE/live
